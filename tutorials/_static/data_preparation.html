<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Data preparation &mdash; paradigma  documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
      <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css?v=fd3f3429" />
      <link rel="stylesheet" type="text/css" href="../../_static/custom.css?v=a31c8b26" />
      <link rel="stylesheet" type="text/css" href="../../_static/custom.css?v=a31c8b26" />

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../_static/documentation_options.js?v=5929fcd5"></script>
        <script src="../../_static/doctools.js?v=9a2dae69"></script>
        <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            paradigma
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">User guides</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../index.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../guides/installation.html">Installation Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../guides/sensor_requirements.html">Sensor Data Requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../guides/supported_devices.html">Supported Devices</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../guides/config.html">Configuration Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../guides/coordinate_system.html">Coordinate System</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developer docs</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../conduct.html">Code of Conduct</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../license.html">License</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../autoapi/index.html">API Reference</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">paradigma</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Data preparation</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/tutorials/_static/data_preparation.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="data-preparation">
<h1>Data preparation<a class="headerlink" href="#data-preparation" title="Link to this heading"></a></h1>
<p>ParaDigMa requires the sensor data to be of a specific format. This tutorial provides examples of how to prepare your input data for subsequent analysis. In the end, the input for ParaDigMa is a dataframe consisting of:</p>
<ul class="simple">
<li><p>A time column representing the seconds relative to the first row of the dataframe;</p></li>
<li><p>One or multiple of the following sensor column categories:</p>
<ul>
<li><p>Triaxial accelerometer (x, y, z) in <em>g</em></p></li>
<li><p>Triaxial gyroscope (x, y, z) in <em>deg/s</em></p></li>
<li><p>Photoplethysmography (PPG)</p></li>
</ul>
</li>
</ul>
<p>The final dataframe should be resampled to 100 Hz, have the correct units for the sensor columns, and the correct format for the time column. Also note that the <em>gait</em> pipeline expects a specific orientation of sensor axes, as explained in <a class="reference internal" href="#../guides/coordinate_system"><span class="xref myst">Coordinate system</span></a>.</p>
<section id="import-required-modules">
<h2>Import required modules<a class="headerlink" href="#import-required-modules" title="Link to this heading"></a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">paradigma.constants</span><span class="w"> </span><span class="kn">import</span> <span class="n">TimeUnit</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">paradigma.util</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">convert_units_accelerometer</span><span class="p">,</span>
    <span class="n">convert_units_gyroscope</span><span class="p">,</span>
    <span class="n">load_tsdf_dataframe</span><span class="p">,</span>
    <span class="n">transform_time_array</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="load-data">
<h2>Load data<a class="headerlink" href="#load-data" title="Link to this heading"></a></h2>
<p>This example uses data of the <a class="reference external" href="https://pubmed.ncbi.nlm.nih.gov/31315608/">Personalized Parkinson Project</a>, which is stored in Time Series Data Format (<code class="docutils literal notranslate"><span class="pre">TSDF</span></code>). Inertial Measurements Units (IMU) and photoplethysmography (PPG) data are sampled at a different sampling frequency and therefore stored separately. Note that ParaDigMa works independent of data storage format; it only requires a <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code> as input.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">path_to_raw_data</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;../../tests/data/data_preparation_tutorial&#39;</span><span class="p">)</span>
<span class="n">path_to_imu_data</span> <span class="o">=</span> <span class="n">path_to_raw_data</span> <span class="o">/</span> <span class="s1">&#39;imu&#39;</span>

<span class="n">df_imu</span><span class="p">,</span> <span class="n">imu_time</span><span class="p">,</span> <span class="n">imu_values</span> <span class="o">=</span> <span class="n">load_tsdf_dataframe</span><span class="p">(</span>
    <span class="n">path_to_data</span><span class="o">=</span><span class="n">path_to_imu_data</span><span class="p">,</span>
    <span class="n">prefix</span><span class="o">=</span><span class="s1">&#39;IMU&#39;</span>
<span class="p">)</span>

<span class="n">df_imu</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>time</th>
      <th>accelerometer_x</th>
      <th>accelerometer_y</th>
      <th>accelerometer_z</th>
      <th>gyroscope_x</th>
      <th>gyroscope_y</th>
      <th>gyroscope_z</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.000000</td>
      <td>-5.402541</td>
      <td>5.632536</td>
      <td>-2.684842</td>
      <td>-115.670732</td>
      <td>-32.012195</td>
      <td>26.097561</td>
    </tr>
    <tr>
      <th>1</th>
      <td>10.040039</td>
      <td>-5.257034</td>
      <td>6.115995</td>
      <td>-2.497091</td>
      <td>-110.609757</td>
      <td>-34.634146</td>
      <td>24.695122</td>
    </tr>
    <tr>
      <th>2</th>
      <td>10.040039</td>
      <td>-4.947244</td>
      <td>6.392928</td>
      <td>-2.468928</td>
      <td>-103.231708</td>
      <td>-36.768293</td>
      <td>22.926829</td>
    </tr>
    <tr>
      <th>3</th>
      <td>10.040039</td>
      <td>-4.792349</td>
      <td>6.735574</td>
      <td>-2.605048</td>
      <td>-96.280488</td>
      <td>-38.719512</td>
      <td>21.158537</td>
    </tr>
    <tr>
      <th>4</th>
      <td>10.039795</td>
      <td>-4.848675</td>
      <td>7.115770</td>
      <td>-2.731780</td>
      <td>-92.560976</td>
      <td>-41.280488</td>
      <td>20.304878</td>
    </tr>
  </tbody>
</table>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">path_to_ppg_data</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_to_raw_data</span><span class="p">,</span> <span class="s1">&#39;ppg&#39;</span><span class="p">)</span>

<span class="n">df_ppg</span><span class="p">,</span> <span class="n">ppg_time</span><span class="p">,</span> <span class="n">ppg_values</span> <span class="o">=</span> <span class="n">load_tsdf_dataframe</span><span class="p">(</span>
    <span class="n">path_to_data</span><span class="o">=</span><span class="n">path_to_ppg_data</span><span class="p">,</span>
    <span class="n">prefix</span><span class="o">=</span><span class="s1">&#39;PPG&#39;</span>
<span class="p">)</span>

<span class="n">df_ppg</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>time</th>
      <th>green</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.000000</td>
      <td>649511</td>
    </tr>
    <tr>
      <th>1</th>
      <td>9.959961</td>
      <td>648214</td>
    </tr>
    <tr>
      <th>2</th>
      <td>9.959961</td>
      <td>646786</td>
    </tr>
    <tr>
      <th>3</th>
      <td>9.959961</td>
      <td>645334</td>
    </tr>
    <tr>
      <th>4</th>
      <td>9.960205</td>
      <td>644317</td>
    </tr>
  </tbody>
</table>
</div>
<p>The timestamps in this dataset correspond to delta milliseconds, and the data is not uniformly distributed as can be observed.</p>
</section>
<section id="prepare-dataframe">
<h2>Prepare dataframe<a class="headerlink" href="#prepare-dataframe" title="Link to this heading"></a></h2>
<section id="set-column-names">
<h3>Set column names<a class="headerlink" href="#set-column-names" title="Link to this heading"></a></h3>
<p>You are free to choose column names, although we recommend using the column names set in ParaDigMa for convenience in subsequent data processing steps. These are accessible through the class <a class="reference external" href="https://biomarkersparkinson.github.io/paradigma/autoapi/paradigma/constants/index.html#paradigma.constants.DataColumns"><code class="docutils literal notranslate"><span class="pre">DataColumns</span></code></a>, which can be imported from <a class="reference external" href="https://biomarkersparkinson.github.io/paradigma/autoapi/paradigma/constants/index.html"><code class="docutils literal notranslate"><span class="pre">paradigma.constants</span></code></a>. For example, we recommend setting <code class="docutils literal notranslate"><span class="pre">acc_x_colname</span></code> to <code class="docutils literal notranslate"><span class="pre">DataColumns.ACCELEROMETER_X</span></code>. Again, this is not strictly necessary for future steps.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">time_colname</span> <span class="o">=</span> <span class="s1">&#39;time&#39;</span>  <span class="c1"># DataColumns.TIME</span>

<span class="n">acc_x_colname</span> <span class="o">=</span> <span class="s1">&#39;accelerometer_x&#39;</span>  <span class="c1"># DataColumns.ACCELEROMETER_X</span>
<span class="n">acc_y_colname</span> <span class="o">=</span> <span class="s1">&#39;accelerometer_y&#39;</span>  <span class="c1"># DataColumns.ACCELEROMETER_Y</span>
<span class="n">acc_z_colname</span> <span class="o">=</span> <span class="s1">&#39;accelerometer_z&#39;</span>  <span class="c1"># DataColumns.ACCELEROMETER_Z</span>
<span class="n">gyr_x_colname</span> <span class="o">=</span> <span class="s1">&#39;gyroscope_x&#39;</span>  <span class="c1"># DataColumns.GYROSCOPE_X</span>
<span class="n">gyr_y_colname</span> <span class="o">=</span> <span class="s1">&#39;gyroscope_y&#39;</span>  <span class="c1"># DataColumns.GYROSCOPE_Y</span>
<span class="n">gyr_z_colname</span> <span class="o">=</span> <span class="s1">&#39;gyroscope_z&#39;</span>  <span class="c1"># DataColumns.GYROSCOPE_Z</span>

<span class="n">ppg_colname</span> <span class="o">=</span> <span class="s1">&#39;green&#39;</span>  <span class="c1"># DataColumns.PPG</span>
</pre></div>
</div>
</section>
<section id="change-units">
<h3>Change units<a class="headerlink" href="#change-units" title="Link to this heading"></a></h3>
<p>ParaDigMa expects acceleration to be measured in g, and rotation in deg/s. Units can be converted conveniently using ParaDigMa functionalities.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set to units of the sampled data</span>
<span class="n">accelerometer_units</span> <span class="o">=</span> <span class="s1">&#39;m/s^2&#39;</span>
<span class="n">gyroscope_units</span> <span class="o">=</span> <span class="s1">&#39;deg/s&#39;</span>

<span class="c1"># State the column names</span>
<span class="n">accelerometer_columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">acc_x_colname</span><span class="p">,</span> <span class="n">acc_y_colname</span><span class="p">,</span> <span class="n">acc_z_colname</span><span class="p">]</span>
<span class="n">gyroscope_columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">gyr_x_colname</span><span class="p">,</span> <span class="n">gyr_y_colname</span><span class="p">,</span> <span class="n">gyr_z_colname</span><span class="p">]</span>

<span class="n">accelerometer_data</span> <span class="o">=</span> <span class="n">df_imu</span><span class="p">[</span><span class="n">accelerometer_columns</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="n">gyroscope_data</span> <span class="o">=</span> <span class="n">df_imu</span><span class="p">[</span><span class="n">gyroscope_columns</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

<span class="c1"># Convert units to expected format</span>
<span class="n">df_imu</span><span class="p">[</span><span class="n">accelerometer_columns</span><span class="p">]</span> <span class="o">=</span> <span class="n">convert_units_accelerometer</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="n">accelerometer_data</span><span class="p">,</span>
    <span class="n">units</span><span class="o">=</span><span class="n">accelerometer_units</span>
<span class="p">)</span>
<span class="n">df_imu</span><span class="p">[</span><span class="n">gyroscope_columns</span><span class="p">]</span> <span class="o">=</span> <span class="n">convert_units_gyroscope</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="n">gyroscope_data</span><span class="p">,</span>
    <span class="n">units</span><span class="o">=</span><span class="n">gyroscope_units</span>
<span class="p">)</span>

<span class="n">df_imu</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>time</th>
      <th>accelerometer_x</th>
      <th>accelerometer_y</th>
      <th>accelerometer_z</th>
      <th>gyroscope_x</th>
      <th>gyroscope_y</th>
      <th>gyroscope_z</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.000000</td>
      <td>-0.550718</td>
      <td>0.574163</td>
      <td>-0.273684</td>
      <td>-115.670732</td>
      <td>-32.012195</td>
      <td>26.097561</td>
    </tr>
    <tr>
      <th>1</th>
      <td>10.040039</td>
      <td>-0.535885</td>
      <td>0.623445</td>
      <td>-0.254545</td>
      <td>-110.609757</td>
      <td>-34.634146</td>
      <td>24.695122</td>
    </tr>
    <tr>
      <th>2</th>
      <td>10.040039</td>
      <td>-0.504306</td>
      <td>0.651675</td>
      <td>-0.251675</td>
      <td>-103.231708</td>
      <td>-36.768293</td>
      <td>22.926829</td>
    </tr>
    <tr>
      <th>3</th>
      <td>10.040039</td>
      <td>-0.488517</td>
      <td>0.686603</td>
      <td>-0.265550</td>
      <td>-96.280488</td>
      <td>-38.719512</td>
      <td>21.158537</td>
    </tr>
    <tr>
      <th>4</th>
      <td>10.039795</td>
      <td>-0.494258</td>
      <td>0.725359</td>
      <td>-0.278469</td>
      <td>-92.560976</td>
      <td>-41.280488</td>
      <td>20.304878</td>
    </tr>
  </tbody>
</table>
</div>
</section>
<section id="account-for-watch-side">
<h3>Account for watch side<a class="headerlink" href="#account-for-watch-side" title="Link to this heading"></a></h3>
<p>For the Gait &amp; Arm Swing pipeline, it is essential to ensure correct sensor axes orientation. For more information please read <a class="reference internal" href="#../guides/coordinate_system"><span class="xref myst">Coordinate System</span></a> and set the axes of the data accordingly.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Change the orientation of the sensor according to the documented coordinate system.</span>
<span class="c1"># The following changes are specific to the used sensor and its orientation</span>
<span class="c1"># relative to predefined coordinate system.</span>
<span class="n">df_imu</span><span class="p">[</span><span class="n">acc_y_colname</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span>
<span class="n">df_imu</span><span class="p">[</span><span class="n">acc_z_colname</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span>
<span class="n">df_imu</span><span class="p">[</span><span class="n">gyr_y_colname</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span>
<span class="n">df_imu</span><span class="p">[</span><span class="n">gyr_z_colname</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span>

<span class="n">df_imu</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>time</th>
      <th>accelerometer_x</th>
      <th>accelerometer_y</th>
      <th>accelerometer_z</th>
      <th>gyroscope_x</th>
      <th>gyroscope_y</th>
      <th>gyroscope_z</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.000000</td>
      <td>-0.550718</td>
      <td>-0.574163</td>
      <td>0.273684</td>
      <td>-115.670732</td>
      <td>32.012195</td>
      <td>-26.097561</td>
    </tr>
    <tr>
      <th>1</th>
      <td>10.040039</td>
      <td>-0.535885</td>
      <td>-0.623445</td>
      <td>0.254545</td>
      <td>-110.609757</td>
      <td>34.634146</td>
      <td>-24.695122</td>
    </tr>
    <tr>
      <th>2</th>
      <td>10.040039</td>
      <td>-0.504306</td>
      <td>-0.651675</td>
      <td>0.251675</td>
      <td>-103.231708</td>
      <td>36.768293</td>
      <td>-22.926829</td>
    </tr>
    <tr>
      <th>3</th>
      <td>10.040039</td>
      <td>-0.488517</td>
      <td>-0.686603</td>
      <td>0.265550</td>
      <td>-96.280488</td>
      <td>38.719512</td>
      <td>-21.158537</td>
    </tr>
    <tr>
      <th>4</th>
      <td>10.039795</td>
      <td>-0.494258</td>
      <td>-0.725359</td>
      <td>0.278469</td>
      <td>-92.560976</td>
      <td>41.280488</td>
      <td>-20.304878</td>
    </tr>
  </tbody>
</table>
</div>
</section>
<section id="change-time-column">
<h3>Change time column<a class="headerlink" href="#change-time-column" title="Link to this heading"></a></h3>
<p>ParaDigMa expects the data to be in seconds relative to the first row, which should be equal to 0. The toolbox has the built-in function <a class="reference external" href="https://biomarkersparkinson.github.io/paradigma/autoapi/paradigma/util/index.html#paradigma.util.transform_time_array"><code class="docutils literal notranslate"><span class="pre">transform_time_array</span></code></a> to help users transform their time column to the correct format if the timestamps have been sampled in delta time between timestamps. In the near future, the functionalities for transforming other types (e.g., datetime format) shall be provided.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df_imu</span><span class="p">[</span><span class="n">time_colname</span><span class="p">]</span> <span class="o">=</span> <span class="n">transform_time_array</span><span class="p">(</span>
    <span class="n">time_array</span><span class="o">=</span><span class="n">df_imu</span><span class="p">[</span><span class="n">time_colname</span><span class="p">],</span>
    <span class="n">input_unit_type</span><span class="o">=</span><span class="n">TimeUnit</span><span class="o">.</span><span class="n">DIFFERENCE_MS</span><span class="p">,</span>
    <span class="n">output_unit_type</span><span class="o">=</span><span class="n">TimeUnit</span><span class="o">.</span><span class="n">RELATIVE_S</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">df_imu</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>time</th>
      <th>accelerometer_x</th>
      <th>accelerometer_y</th>
      <th>accelerometer_z</th>
      <th>gyroscope_x</th>
      <th>gyroscope_y</th>
      <th>gyroscope_z</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.00000</td>
      <td>-0.550718</td>
      <td>-0.574163</td>
      <td>0.273684</td>
      <td>-115.670732</td>
      <td>32.012195</td>
      <td>-26.097561</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.01004</td>
      <td>-0.535885</td>
      <td>-0.623445</td>
      <td>0.254545</td>
      <td>-110.609757</td>
      <td>34.634146</td>
      <td>-24.695122</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.02008</td>
      <td>-0.504306</td>
      <td>-0.651675</td>
      <td>0.251675</td>
      <td>-103.231708</td>
      <td>36.768293</td>
      <td>-22.926829</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.03012</td>
      <td>-0.488517</td>
      <td>-0.686603</td>
      <td>0.265550</td>
      <td>-96.280488</td>
      <td>38.719512</td>
      <td>-21.158537</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.04016</td>
      <td>-0.494258</td>
      <td>-0.725359</td>
      <td>0.278469</td>
      <td>-92.560976</td>
      <td>41.280488</td>
      <td>-20.304878</td>
    </tr>
  </tbody>
</table>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df_ppg</span><span class="p">[</span><span class="n">time_colname</span><span class="p">]</span> <span class="o">=</span> <span class="n">transform_time_array</span><span class="p">(</span>
    <span class="n">time_array</span><span class="o">=</span><span class="n">df_ppg</span><span class="p">[</span><span class="n">time_colname</span><span class="p">],</span>
    <span class="n">input_unit_type</span><span class="o">=</span><span class="n">TimeUnit</span><span class="o">.</span><span class="n">DIFFERENCE_MS</span><span class="p">,</span>
    <span class="n">output_unit_type</span><span class="o">=</span><span class="n">TimeUnit</span><span class="o">.</span><span class="n">RELATIVE_S</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">df_ppg</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>time</th>
      <th>green</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.00000</td>
      <td>649511</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.00996</td>
      <td>648214</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.01992</td>
      <td>646786</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.02988</td>
      <td>645334</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.03984</td>
      <td>644317</td>
    </tr>
  </tbody>
</table>
</div>
<p>These dataframes are ready to be processed by ParaDigMa.</p>
</section>
</section>
<section id="note-on-non-contiguous-data">
<h2>Note on Non-Contiguous Data<a class="headerlink" href="#note-on-non-contiguous-data" title="Link to this heading"></a></h2>
<p>If your data has gaps or interruptions (e.g., battery died, device removed, multiple recording sessions), you have two options:</p>
<section id="option-1-auto-segmentation-recommended">
<h3>Option 1: Auto-segmentation (Recommended)<a class="headerlink" href="#option-1-auto-segmentation-recommended" title="Link to this heading"></a></h3>
<p>Use the <code class="docutils literal notranslate"><span class="pre">split_by_gaps=True</span></code> parameter in <code class="docutils literal notranslate"><span class="pre">run_paradigma()</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">paradigma.orchestrator</span><span class="w"> </span><span class="kn">import</span> <span class="n">run_paradigma</span>

<span class="n">results</span> <span class="o">=</span> <span class="n">run_paradigma</span><span class="p">(</span>
    <span class="n">dfs</span><span class="o">=</span><span class="n">df_prepared</span><span class="p">,</span>
    <span class="n">pipelines</span><span class="o">=</span><span class="s1">&#39;gait&#39;</span><span class="p">,</span>
    <span class="n">watch_side</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span>
    <span class="n">split_by_gaps</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>             <span class="c1"># Automatically handle gaps</span>
    <span class="n">max_gap_seconds</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>            <span class="c1"># Split on gaps &gt; 1.5s</span>
    <span class="n">min_segment_seconds</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span>        <span class="c1"># Discard segments &lt; 2s</span>
<span class="p">)</span>
</pre></div>
</div>
<p>This will:</p>
<ul class="simple">
<li><p>Automatically detect and split data at gaps larger than <code class="docutils literal notranslate"><span class="pre">max_gap_seconds</span></code></p></li>
<li><p>Discard segments shorter than <code class="docutils literal notranslate"><span class="pre">min_segment_seconds</span></code></p></li>
<li><p>Process each contiguous segment independently</p></li>
<li><p>Add a <code class="docutils literal notranslate"><span class="pre">data_segment_nr</span></code> column to track recording chunks</p></li>
</ul>
</section>
<section id="option-2-manual-segmentation">
<h3>Option 2: Manual segmentation<a class="headerlink" href="#option-2-manual-segmentation" title="Link to this heading"></a></h3>
<p>Create segments yourself using functions from <a class="reference internal" href="#../../src/paradigma/segmenting.py"><span class="xref myst">segmenting.py</span></a>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">paradigma.segmenting</span><span class="w"> </span><span class="kn">import</span> <span class="n">create_segments</span><span class="p">,</span> <span class="n">discard_segments</span>

<span class="c1"># Create segments based on time gaps</span>
<span class="n">df_prepared</span><span class="p">[</span><span class="s1">&#39;data_segment_nr&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">create_segments</span><span class="p">(</span>
    <span class="n">time_array</span><span class="o">=</span><span class="n">df_prepared</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
    <span class="n">max_segment_gap_s</span><span class="o">=</span><span class="mf">1.5</span>
<span class="p">)</span>

<span class="c1"># Optionally discard short segments</span>
<span class="n">df_prepared</span> <span class="o">=</span> <span class="n">discard_segments</span><span class="p">(</span>
    <span class="n">df</span><span class="o">=</span><span class="n">df_prepared</span><span class="p">,</span>
    <span class="n">segment_nr_colname</span><span class="o">=</span><span class="s1">&#39;data_segment_nr&#39;</span><span class="p">,</span>
    <span class="n">min_segment_length_s</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span>
    <span class="n">fs</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>  <span class="c1"># sampling frequency</span>
    <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;timestamps&#39;</span>
<span class="p">)</span>

<span class="c1"># Then run paradigma normally (split_by_gaps=False)</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">run_paradigma</span><span class="p">(</span>
    <span class="n">dfs</span><span class="o">=</span><span class="n">df_prepared</span><span class="p">,</span>
    <span class="n">pipelines</span><span class="o">=</span><span class="s1">&#39;gait&#39;</span><span class="p">,</span>
    <span class="n">watch_side</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span>
    <span class="n">split_by_gaps</span><span class="o">=</span><span class="kc">False</span>  <span class="c1"># Data already segmented</span>
<span class="p">)</span>
</pre></div>
</div>
<p>For more details and examples, see the <a class="reference external" href="https://biomarkersparkinson.github.io/paradigma/tutorials/pipeline_orchestrator.html#auto-segmentation-for-non-contiguous-data">Pipeline Orchestrator Tutorial</a>.</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Erik Post, Kars Veldkamp, Nienke Timmermans, Diogo Coutinho Soriano, Vedran Kasalica, Peter Kok, and Luc Evers.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>